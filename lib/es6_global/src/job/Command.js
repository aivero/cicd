// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Seq from "../std/Seq.js";
import * as Flat from "../std/Flat.js";
import * as Task from "../std/Task.js";
import * as Belt_Array from "../../../../node_modules/rescript/lib/es6/belt_Array.js";
import * as Belt_Result from "../../../../node_modules/rescript/lib/es6/belt_Result.js";

function getInstances($$int) {
  return {
          TAG: /* Ok */0,
          _0: Belt_Array.map($$int.profiles, (function (profile) {
                  return {
                          base: $$int,
                          profile: profile
                        };
                }))
        };
}

function getJobs(ints) {
  return Task.resolve(Belt_Result.flatMap(Seq.result(Belt_Array.map(ints.filter(function ($$int) {
                              return $$int.mode === "command";
                            }), getInstances)), (function (ints) {
                    var ints$1 = Flat.array(ints);
                    return Seq.result(Belt_Array.map(ints$1, (function (param) {
                                      var profile = param.profile;
                                      var match = param.base;
                                      return {
                                              TAG: /* Ok */0,
                                              _0: {
                                                name: match.name + "-" + profile,
                                                extends: undefined,
                                                variables: undefined,
                                                image: match.image,
                                                tags: undefined,
                                                script: match.cmds,
                                                needs: Belt_Array.map(match.reqs, (function (need) {
                                                        return need + "-" + profile;
                                                      })),
                                                services: undefined
                                              }
                                            };
                                    })));
                  })));
}

export {
  getInstances ,
  getJobs ,
  
}
/* No side effect */
